<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Mortalidad de Larvas zoea 1 de Taliepus dentatus bajo 3 temperaturas distintas</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Mortalidad</a>
</li>
<li>
  <a href="about.html">Morfometría</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Mortalidad de Larvas zoea 1 de Taliepus dentatus bajo 3 temperaturas distintas</h1>

</div>


<div id="paquetes-utilizados-a-lo-largo-del-script." class="section level1">
<h1>Paquetes utilizados a lo largo del Script.</h1>
<pre class="r"><code>library(cowplot)
library(scales)
library(dplyr)
library(gridExtra)
library(tidyverse)
library(ggsci)
library(ggplot2)
library(Rmisc)
library(survminer)
library(survival)
library(MASS)</code></pre>
</div>
<div id="importación-de-base-de-datos-definición-de-factores-y-creación-de-figura-numero-7." class="section level1">
<h1>Importación de base de datos, definición de factores y creación de figura numero 7.</h1>
<pre class="r"><code>#Importo base de datos.
Mort&lt;-read.delim(&quot;/Users/lucasb/Dropbox/Mac/Desktop/TESIS/TESIS B/RESULTADOS/mort.txt&quot;)
Mort$bino&lt;-Mort$Vivas/100


#Defino temperatura como un factor
Mort$Temperatura&lt;-as.factor(Mort$Temperatura)


#Grafico de la supervivencia en las tres temperaturas por cada frasco 
Grafico_frascos&lt;-ggplot(Mort, aes(x=Dia, y=Vivas, colour=Temperatura)) + geom_point() + theme_classic() + ggtitle(&quot;Supervivencia&quot;)+facet_wrap(~Temperatura*Frasco) + labs(x=&quot;Día&quot;, subtitle = &quot;Replicas (A-B-C) por Temperatura&quot;)
Grafico_frascos + scale_colour_manual(values =c(&quot;dodgerblue1&quot;, &quot;green3&quot;, &quot;firebrick1&quot;), labels=c(&quot;12°C&quot;,&quot;15°C&quot;,&quot;17°C&quot;))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="preparando-tabla-con-estadisticos-basicos-sd-se-ci-mean-para-analisis-de-lt50-y-kaplan-meier." class="section level1">
<h1>Preparando tabla con estadisticos basicos (SD, SE, CI, MEAN) para analisis de LT50 y Kaplan-meier.</h1>
<pre class="r"><code>#Estadisticos basicos (SD, SE, CI, MEAN)
LT50_summary&lt;- summarySE(Mort, measurevar=&quot;bino&quot;, groupvars=c(&quot;Temperatura&quot;,&quot;Dia&quot;))
print(LT50_summary)</code></pre>
<pre><code>##    Temperatura Dia N        bino          sd          se         ci
## 1           12   1 3 1.000000000 0.000000000 0.000000000 0.00000000
## 2           12   2 3 0.976666667 0.005773503 0.003333333 0.01434218
## 3           12   3 3 0.500000000 0.115325626 0.066583281 0.28648474
## 4           12   4 3 0.306666667 0.210792157 0.121700908 0.52363675
## 5           12   5 3 0.296666667 0.202319879 0.116809436 0.50259044
## 6           12   6 3 0.296666667 0.202319879 0.116809436 0.50259044
## 7           12   7 3 0.296666667 0.202319879 0.116809436 0.50259044
## 8           12   8 3 0.276666667 0.176162803 0.101707642 0.43761266
## 9           12   9 3 0.240000000 0.165227116 0.095393920 0.41044691
## 10          12  10 3 0.050000000 0.043588989 0.025166115 0.10828105
## 11          12  11 3 0.000000000 0.000000000 0.000000000 0.00000000
## 12          15   1 3 1.000000000 0.000000000 0.000000000 0.00000000
## 13          15   2 3 1.000000000 0.000000000 0.000000000 0.00000000
## 14          15   3 3 0.920000000 0.017320508 0.010000000 0.04302653
## 15          15   4 3 0.883333333 0.028867513 0.016666667 0.07171088
## 16          15   5 3 0.826666667 0.025166115 0.014529663 0.06251609
## 17          15   6 3 0.606666667 0.072341781 0.041766547 0.17970695
## 18          15   7 3 0.376666667 0.081445278 0.047022453 0.20232129
## 19          15   8 3 0.216666667 0.075055535 0.043333333 0.18644828
## 20          15   9 3 0.123333333 0.035118846 0.020275875 0.08724005
## 21          15  10 3 0.033333333 0.025166115 0.014529663 0.06251609
## 22          15  11 3 0.000000000 0.000000000 0.000000000 0.00000000
## 23          17   1 3 0.983333333 0.028867513 0.016666667 0.07171088
## 24          17   2 3 0.953333333 0.037859389 0.021858128 0.09404794
## 25          17   3 3 0.913333333 0.015275252 0.008819171 0.03794583
## 26          17   4 3 0.886666667 0.030550505 0.017638342 0.07589166
## 27          17   5 3 0.846666667 0.045092498 0.026034166 0.11201597
## 28          17   6 3 0.580000000 0.052915026 0.030550505 0.13144821
## 29          17   7 3 0.230000000 0.108166538 0.062449980 0.26870058
## 30          17   8 3 0.020000000 0.010000000 0.005773503 0.02484138
## 31          17   9 3 0.003333333 0.005773503 0.003333333 0.01434218
## 32          17  10 3 0.000000000 0.000000000 0.000000000 0.00000000</code></pre>
</div>
<div id="analisis-estadistico-de-lt50-quasibinomial-tasas-de-mortalidad-y-creación-de-grafico." class="section level1">
<h1>Analisis estadistico de LT50 (quasibinomial), tasas de mortalidad y creación de grafico.</h1>
<pre class="r"><code>#Separación de tabla por temperatura
mort_12&lt;-LT50_summary[1:11, ]
mort_15&lt;-LT50_summary[12:22, ]
mort_17&lt;-LT50_summary[23:32,]

#Modelo lineales generalizados por temperatura, que permitieron obtener tasas de mortalidad
model1&lt;-glm(data=mort_12, bino ~ Dia, family=quasibinomial())
summary(model1)</code></pre>
<pre><code>## 
## Call:
## glm(formula = bino ~ Dia, family = quasibinomial(), data = mort_12)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.5179  -0.2999  -0.0738   0.3400   0.5964  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   2.1710     0.6380   3.403  0.00784 **
## Dia          -0.4791     0.1117  -4.289  0.00202 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.1436587)
## 
##     Null deviance: 5.4993  on 10  degrees of freedom
## Residual deviance: 1.5399  on  9  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<pre class="r"><code>model2&lt;-glm(data=mort_15, bino ~ Dia, family=quasibinomial())
summary(model2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = bino ~ Dia, family = quasibinomial(), data = mort_15)
## 
## Deviance Residuals: 
##       Min         1Q     Median         3Q        Max  
## -0.185582  -0.053923  -0.005199   0.088830   0.186640  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.84038    0.37027   15.77 7.28e-08 ***
## Dia         -0.89940    0.05508  -16.33 5.39e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.01151942)
## 
##     Null deviance: 8.21286  on 10  degrees of freedom
## Residual deviance: 0.13672  on  9  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>model3&lt;-glm(data=mort_17, bino ~ Dia, family=quasibinomial())
summary(model3)</code></pre>
<pre><code>## 
## Call:
## glm(formula = bino ~ Dia, family = quasibinomial(), data = mort_17)
## 
## Deviance Residuals: 
##       Min         1Q     Median         3Q        Max  
## -0.287545  -0.221565  -0.146333  -0.006668   0.263467  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.6331     0.9512   6.974 0.000116 ***
## Dia          -1.1205     0.1559  -7.186 9.37e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasibinomial family taken to be 0.05103717)
## 
##     Null deviance: 8.41356  on 9  degrees of freedom
## Residual deviance: 0.38809  on 8  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>#dose.p utiliza los modelos lineales para encontrar la dosis (día) sobre el cual el p=0.5 (50% de la población) ya ha muerto. 
print(dose.p(model1, p = 0.5))</code></pre>
<pre><code>##              Dose        SE
## p = 0.5: 4.531844 0.6121778</code></pre>
<pre class="r"><code>print(dose.p(model2, p = 0.5))</code></pre>
<pre><code>##              Dose      SE
## p = 0.5: 6.493628 0.11405</code></pre>
<pre class="r"><code>print(dose.p(model3, p = 0.5))</code></pre>
<pre><code>##              Dose        SE
## p = 0.5: 5.919705 0.2142654</code></pre>
<pre class="r"><code>#CREACIÓN DE GRAFICO FINAL (DIFERENCIAS ENTRE LT50), estos datos se extraen de los resultados de dose.p
lt50&lt;-c(4.531844, 6.493628, 5.919705)
CI&lt;-c(0.6121778*1.95, 0.11405*1.95, 0.2142654*1.95)
temp&lt;-c(12, 15,17)
data_final&lt;-data.frame(lt50, CI, temp)
data_final$temp&lt;-as.factor(data_final$temp)


lt50_plot&lt;-ggplot(data_final, aes(x=temp, y=lt50, fill=temp))+ geom_bar(stat=&quot;identity&quot;) + theme_classic() + labs(title = &quot;Dosis letal (50% de la población muere)&quot;, x=&quot;&quot;, y=&quot;Día&quot;, fill= &quot;Temperatura&quot;) + scale_fill_manual(values =c(&quot;dodgerblue1&quot;, &quot;green3&quot;, &quot;firebrick1&quot;), labels=c(&quot;12°C&quot;,&quot;15°C&quot;,&quot;17°C&quot;)) 
lt50_plot + geom_errorbar(aes(ymin=lt50-CI, ymax=lt50+CI), width=.2, position=position_dodge(0.05)) + geom_text(aes(label=c(&quot;4.50&quot;,&quot;6.50&quot;,&quot;5.90&quot;)),position = position_dodge(0.9), vjust = 10) </code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="analisis-de-kaplan-meier" class="section level1">
<h1>Analisis de Kaplan-Meier</h1>
<pre class="r"><code>##reorden de la tabla correcto para el analisis
repV&lt;- Mort$Muertas 
  repV[repV==&quot;0&quot;]&lt;-1

KAP&lt;-Mort %&gt;%
  mutate(count = repV) %&gt;%
  uncount(count)

KAP$STATUS &lt;- ifelse (KAP$Muertas==0, 1, 2)
survObj &lt;- Surv(time=KAP$Dia, event=KAP$STATUS==2)

#Analisis de Kaplan-Meier
sfit &lt;- survfit(Surv(Dia, STATUS)~Temperatura, data=KAP)

#Grafico de Kaplan-Meier
ggsurvplot(sfit, conf.int=TRUE, pval=TRUE, risk.table=FALSE, 
           legend.labs=c(&quot;12°C&quot;, &quot;15°C&quot;,&quot;17°C&quot;), legend.title=&quot;Temperatura&quot;,  
           palette=(c(&quot;dodgerblue1&quot;, &quot;green3&quot;, &quot;firebrick1&quot;)), 
           title=&quot;Kaplan-Meier Curve for Zoea 1 Survival to Temperature&quot;, 
           risk.table.height=.15, ylab=&quot;Supervivencia&quot;, xlab=&quot;Día&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
